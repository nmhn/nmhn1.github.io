{
    "version": "https://jsonfeed.org/version/1",
    "title": "年没怀念der博客",
    "subtitle": "",
    "icon": "http://example.com/images/favicon.ico",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2021/12/06/21-12-6-Database-exp-8/",
            "url": "http://example.com/2021/12/06/21-12-6-Database-exp-8/",
            "title": "21/12/6 Database exp 8",
            "date_published": "2021-12-06T11:09:47.000Z",
            "content_html": "<ol>\n<li>\n<h1 id=\"分析系统功能\"><a class=\"anchor\" href=\"#分析系统功能\">#</a> 分析系统功能</h1>\n<ol>\n<li>\n<h2 id=\"er图\"><a class=\"anchor\" href=\"#er图\">#</a> ER 图</h2>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120140233739.png\" alt=\"image-20211120140233739\" /></p>\n</li>\n<li>\n<h2 id=\"关系模型\"><a class=\"anchor\" href=\"#关系模型\">#</a> 关系模型</h2>\n<ol>\n<li>\n<h3 id=\"对象的属性描述\"><a class=\"anchor\" href=\"#对象的属性描述\">#</a> 对象的属性描述</h3>\n<p>客户 (&lt;u&gt; 客户编号 &lt;/u&gt;, 电子邮箱，登录密码，身份证，联系方式，姓名)<br />\n 银行卡 (&lt;u&gt; 卡号 &lt;/u&gt;, 类型，客户编号)<br />\n 理财产品 (&lt;u&gt; 理财产品编号 &lt;/u&gt;, 理财年限，购买金额，产品名称，产品描述)<br />\n 基金 (&lt;u&gt; 基金编号 &lt;/u&gt;, 基金名称，基金类型，风险等级，基金管理者，基金金额)<br />\n 保险 (&lt;u&gt; 保险编号 &lt;/u&gt;, 保险名称，适用人群，保险项目，保险金额，保险年限)<br />\n 资产 (&lt;u&gt; 客户编号 &lt;/u&gt;,&lt;u &gt; 资产编号 &lt;/u&gt;, 状态，购买数量，收益，购买时间)</p>\n</li>\n<li>\n<h3 id=\"对象之间关系描述\"><a class=\"anchor\" href=\"#对象之间关系描述\">#</a> 对象之间关系描述</h3>\n<p>一个客户可以购买多种理财产品<br />\n可以办理多张银行卡<br />\n一个客户可以购买多种保险<br />\n一个客户可以购买多种基金<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120145443968.png\" alt=\"image-20211120145443968\" /></p>\n</li>\n</ol>\n</li>\n</ol>\n</li>\n<li>\n<h2 id=\"物理设计与数据字典\"><a class=\"anchor\" href=\"#物理设计与数据字典\">#</a> 物理设计与数据字典</h2>\n<ol>\n<li>\n<h3 id=\"表及其属性\"><a class=\"anchor\" href=\"#表及其属性\">#</a> 表及其属性</h3>\n<p>client(c_id,c_name,c_mail,c_id_card,c_phone,c_password)<br />\nbank_card(b_id,b_type,b_c_id)<br />\nproperty(p_id,p_c_id,p_i_id,p_status,p_amount,p_get_time,p_income,p_type)<br />\nfund(f_name,f_id,f_type,f_amount,risk_level,f_manager)<br />\ninsurance(i_name,i_id,i_amount,i_person,i_year,i_project)<br />\nf_product(fp_id,fp_name，fp_description，fp_amount，fp_year)</p>\n</li>\n<li>\n<h3 id=\"数据字典\"><a class=\"anchor\" href=\"#数据字典\">#</a> 数据字典</h3>\n<ol>\n<li>\n<h4 id=\"表1-1-client表\"><a class=\"anchor\" href=\"#表1-1-client表\">#</a> 表 1-1 client 表</h4>\n<table>\n<thead>\n<tr>\n<th><strong>字段名称</strong></th>\n<th><strong>字段类型</strong></th>\n<th><strong>约束</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>c_id</td>\n<td>INTEGER</td>\n<td>PRIMARY KEY</td>\n<td>客户编码</td>\n</tr>\n<tr>\n<td>c_name</td>\n<td>VARCHAR(100)</td>\n<td>NOT NULL</td>\n<td>客户名称</td>\n</tr>\n<tr>\n<td>c_mail</td>\n<td>CHAR(30)</td>\n<td>UNIQUE</td>\n<td>客户邮箱</td>\n</tr>\n<tr>\n<td>c_id_card</td>\n<td>CHAR(20)</td>\n<td>UNIQUE NOT NULL</td>\n<td>客户身份证</td>\n</tr>\n<tr>\n<td>c_phone</td>\n<td>CHAR(20)</td>\n<td>UNIQUE NOT NULL</td>\n<td>客户手机号</td>\n</tr>\n<tr>\n<td>c_password</td>\n<td>CHAR(20)</td>\n<td>NOT NULL</td>\n<td>客户登录密码</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<h4 id=\"表1-2bank_card表\"><a class=\"anchor\" href=\"#表1-2bank_card表\">#</a> 表 1-2bank_card 表</h4>\n<table>\n<thead>\n<tr>\n<th><strong>字段名称</strong></th>\n<th><strong>字段类型</strong></th>\n<th><strong>约束</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>b_id</td>\n<td>INTEGER</td>\n<td>PRIMARY KEY</td>\n<td>银行卡号</td>\n</tr>\n<tr>\n<td>b_type</td>\n<td>CHAR(20)</td>\n<td>NOT NULL</td>\n<td>银行卡类型</td>\n</tr>\n<tr>\n<td>b_c_id</td>\n<td>INTERGER</td>\n<td>NOT NULL  &lt;br /&gt;FOREIGNKEY</td>\n<td>客户编号</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<h4 id=\"表1-3-property资产表\"><a class=\"anchor\" href=\"#表1-3-property资产表\">#</a> 表 1-3 property 资产表</h4>\n<table>\n<thead>\n<tr>\n<th><strong>字段名称</strong></th>\n<th><strong>字段类型</strong></th>\n<th><strong>约束</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>p_id</td>\n<td>INTEGER</td>\n<td>PRIMARY KEY</td>\n<td>资产编号</td>\n</tr>\n<tr>\n<td>p_c_id</td>\n<td>INTEGER</td>\n<td>NOT NULL&lt;br /&gt;FOREIGN KEY</td>\n<td>客户编号 &lt;br /&gt; 外键，对应 client 中的 c_id</td>\n</tr>\n<tr>\n<td>p_i_id</td>\n<td>INTEGER</td>\n<td>NOT NULL&lt;br /&gt;FOREIGN KEY</td>\n<td>商品编号，对应三种产品的 id</td>\n</tr>\n<tr>\n<td>p_status</td>\n<td>CHAR(20)</td>\n<td>NOT NULL</td>\n<td>状态</td>\n</tr>\n<tr>\n<td>p_amount</td>\n<td>INTERGER</td>\n<td>NOT NULL</td>\n<td>购买数量</td>\n</tr>\n<tr>\n<td>p_get_time</td>\n<td>DATE</td>\n<td>NOT NULL</td>\n<td>购买时间</td>\n</tr>\n<tr>\n<td>p_income</td>\n<td>INTERGER</td>\n<td></td>\n<td>收益</td>\n</tr>\n<tr>\n<td>p_type</td>\n<td>INTERGER</td>\n<td>NOT NULL</td>\n<td>1 代表是理财产品，2 代表保险，3 代表基金</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<h4 id=\"表1-4-f_products-理财产品表\"><a class=\"anchor\" href=\"#表1-4-f_products-理财产品表\">#</a> 表 1-4 f_products 理财产品表</h4>\n<table>\n<thead>\n<tr>\n<th><strong>字段名称</strong></th>\n<th><strong>字段类型</strong></th>\n<th><strong>约束</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>fp_id</td>\n<td>INTEGER</td>\n<td>PRIMARY KEY</td>\n<td>理财产品编号</td>\n</tr>\n<tr>\n<td>fp_year</td>\n<td>INTEGER</td>\n<td></td>\n<td>理财年限</td>\n</tr>\n<tr>\n<td>fp_amount</td>\n<td>INTERGER</td>\n<td></td>\n<td>购买金额</td>\n</tr>\n<tr>\n<td>fp_name</td>\n<td>VARCHAR(200)</td>\n<td>NOT NULL</td>\n<td>产品名称</td>\n</tr>\n<tr>\n<td>fp_description</td>\n<td>VARCHAR(2000)</td>\n<td>NOT NULL</td>\n<td>产品描述</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<h4 id=\"表1-5-insurance-保险表\"><a class=\"anchor\" href=\"#表1-5-insurance-保险表\">#</a> 表 1-5 insurance 保险表</h4>\n<table>\n<thead>\n<tr>\n<th><strong>字段名称</strong></th>\n<th><strong>字段类型</strong></th>\n<th><strong>约束</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>i_id</td>\n<td>INTEGER</td>\n<td>PRIMARY KEY</td>\n<td>保险编号</td>\n</tr>\n<tr>\n<td>i_name</td>\n<td>VARCHAR(100)</td>\n<td>NOT NULL</td>\n<td>保险名称</td>\n</tr>\n<tr>\n<td>i_person</td>\n<td>CHAR(30)</td>\n<td></td>\n<td>适用人群</td>\n</tr>\n<tr>\n<td>i_project</td>\n<td>VARCHAR(200)</td>\n<td></td>\n<td>保险项目</td>\n</tr>\n<tr>\n<td>i_amount</td>\n<td>INTERGER</td>\n<td></td>\n<td>保险金额</td>\n</tr>\n<tr>\n<td>i_year</td>\n<td>CHAR(20)</td>\n<td>NOT NULL</td>\n<td>保险年限</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<h4 id=\"表1-6-fund基金表\"><a class=\"anchor\" href=\"#表1-6-fund基金表\">#</a> 表 1-6 fund 基金表</h4>\n<table>\n<thead>\n<tr>\n<th><strong>字段名称</strong></th>\n<th><strong>字段类型</strong></th>\n<th><strong>约束</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>f_id</td>\n<td>INTEGER</td>\n<td>PRIMARY KEY</td>\n<td>基金编号</td>\n</tr>\n<tr>\n<td>f_name</td>\n<td>VARCHAR(100)</td>\n<td>NOT NULL</td>\n<td>基金名称</td>\n</tr>\n<tr>\n<td>f_type</td>\n<td>CHAR(30)</td>\n<td></td>\n<td>基金类型</td>\n</tr>\n<tr>\n<td>f_risk</td>\n<td>INTERGER</td>\n<td></td>\n<td>风险等级</td>\n</tr>\n<tr>\n<td>f_manager</td>\n<td>INTERGER</td>\n<td>NOT NULL</td>\n<td>基金管理者</td>\n</tr>\n<tr>\n<td>f_amount</td>\n<td>INTERGER</td>\n<td>NOT NULL</td>\n<td>基金金额</td>\n</tr>\n</tbody>\n</table>\n</li>\n</ol>\n</li>\n</ol>\n</li>\n<li>\n<p>创建数据库表</p>\n<ol>\n<li>\n<p>创建 finance 数据库作为项目数据库，数据库编码为 UTF-8。（2 分）</p>\n<ol>\n<li>切换到 omm 用户<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120152854123.png\" alt=\"image-20211120152854123\" /></li>\n<li>启动数据库服务<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120152924367.png\" alt=\"image-20211120152924367\" /></li>\n<li>登入 postres 数据库 (为了在里面创建新的数据库)<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120152949937.png\" alt=\"image-20211120152949937\" /></li>\n<li>创建 finance 数据库，设置编码为 UTF-8<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120153159839.png\" alt=\"image-20211120153159839\" /></li>\n</ol>\n</li>\n<li>\n<p>连接 finance 数据库，创建名为 finance 的 schema，并设置 finance 为当前的 schema。（2 分）</p>\n<ol>\n<li>连接 finance 数据库<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120153222258.png\" alt=\"image-20211120153222258\" /></li>\n<li>创建名为 finance 的 schema，并设置 finance 为当前的 schema<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120153259340.png\" alt=\"image-20211120153259340\" /></li>\n</ol>\n</li>\n<li>\n<p>在 finance 模式下完成金融管理系统中所有数据库对象（数据表）的创建，并完成数据的填充。其中客户数据不少于 20 条，银行卡数据不少于 10 条，其他数据不少于 5 条；（6 分）</p>\n<ol>\n<li>\n<p>数据表创建</p>\n<ol>\n<li>\n<p>客户表创建</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120162145657.png\" alt=\"image-20211120162145657\" /></p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120162136314.png\" alt=\"image-20211120162136314\" /></p>\n</li>\n<li>\n<p>银行卡表创建<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161519458.png\" alt=\"image-20211120161519458\" /><br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161510470.png\" alt=\"image-20211120161510470\" /></p>\n</li>\n<li>\n<p>理财产品表创建<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161622995.png\" alt=\"image-20211120161622995\" /></p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161716375.png\" alt=\"image-20211120161716375\" /></p>\n</li>\n<li>\n<p>保险信息表创建</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161636166.png\" alt=\"image-20211120161636166\" /><br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161724463.png\" alt=\"image-20211120161724463\" /></p>\n</li>\n<li>\n<p>基金信息表创建</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161645388.png\" alt=\"image-20211120161645388\" /></p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161745238.png\" alt=\"image-20211120161745238\" /></p>\n</li>\n<li>\n<p>资产信息表创建</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161659959.png\" alt=\"image-20211120161659959\" /></p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120161759138.png\" alt=\"image-20211120161759138\" /></p>\n</li>\n</ol>\n</li>\n<li>\n<p>添加数据</p>\n<ol>\n<li>\n<p>客户信息添加<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120163251246.png\" alt=\"image-20211120163251246\" /></p>\n</li>\n<li>\n<p>银行卡数据填充<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120163727388.png\" alt=\"image-20211120163727388\" /></p>\n</li>\n<li>\n<p>理财产品填充</p>\n<p>INSERT INTO finance.f_products</p>\n<p>(fp_id  ,fp_year   ,fp_amount  ,fp_name   ,fp_description ) VALUES</p>\n<p>(1    ,2      ,4000000   ,' 储蓄 '   ,' 储蓄理财产品 '),</p>\n<p>(2    ,1      ,3000    ,' 债券 '   ,' 债券是政府、企业、银行等债务人为筹集资金，按照法定程序发行并向债权人承诺于指定日期还本付息的有价证券 '),</p>\n<p>(3    ,1      ,200000   ,' 股票 '   ,' 股份公司为筹集资金而发行给各个股东作为持股凭证并借以取得股息和红利的一种有价证券 '),</p>\n<p>(4    ,3      ,2000    ,' 国债 '   ,' 国家以其信用为基础，按照债的一般原则，通过向社会筹集资金所形成的债权债务关系 '),</p>\n<p>(5    ,2      ,10000    ,' 大宗商品 ' ,' 与大宗商品期货挂钩的理财产品。目前市场上主要以挂钩黄金、石油、农产品的理财产品居多 ')<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120174858479.png\" alt=\"image-20211120174858479\" /></p>\n</li>\n<li>\n<p>保险产品填充</p>\n<p>INSERT INTO finance.insurance(i_name,i_id,i_amount,i_person,i_year,i_project) VALUES</p>\n<p>(' 意外保险 ',3,5000,' 所有人 ',20,' 平安保险 '),</p>\n<p>(' 医疗保险 ',4,2000,' 所有人 ',20,' 平安保险 '),</p>\n<p>(' 健康保险 ',1,2000,' 老年人 ',10,' 平安保险 '),</p>\n<p>(' 人寿保险 ',2,3000,' 老年人 ',10,' 平安保险 '),</p>\n<p>(' 财产损失保险 ',5,1500,' 中年人 ',3,' 平安保险 ');<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120175159475.png\" alt=\"image-20211120175159475\" /></p>\n</li>\n<li>\n<p>基金表格填充</p>\n<p>INSERT INTO finance.fund (f_id,fp_name,f_type,f_risk,f_manager,f_amount) VALUES</p>\n<p>(1,' 股票基金 ',' 股票型 ',3,1,200000),</p>\n<p>(2,' 债券基金 ',' 债券型 ',2,2,3000),</p>\n<p>(3,' 投资基金 ',' 债券型 ',3,2,1000),</p>\n<p>(4,' 国债 ',' 货币型 ',1,4,2000),</p>\n<p>(5,' 期货 ',' 期货型 ',2,5,1500);</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120180449122.png\" alt=\"image-20211120180449122\" /></p>\n</li>\n<li>\n<p>资产表格填充</p>\n<p>INSERT INTO finance.property</p>\n<p>(p_id  , p_c_id   ,p_i_id , p_status  , p_amount  ,p_get_time   ,p_income  ,p_type ) VALUES</p>\n<p>(1    ,1      ,1    ,' 可用 '   ,100     ,'2021-11-20'  ,2000    ,1),</p>\n<p>(2    ,1      ,2    ,' 可用 '   ,100     ,'2021-11-21'  ,3020    ,1),</p>\n<p>(3    ,1      ,1    ,' 冻结 '   ,100     ,'2021-11-20'  ,2000    ,2),</p>\n<p>(4    ,1      ,4    ,' 可用 '   ,101     ,'2021-11-10'  ,3000    ,3),</p>\n<p>(5    ,2      ,5    ,' 可用 '   ,100     ,'2021-11-20'  ,2000    ,2)</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120181110730.png\" alt=\"image-20211120181110730\" /></p>\n</li>\n</ol>\n</li>\n</ol>\n</li>\n<li>\n<p>对表添加外键约束，在银行信息表和资产信息表中，都存在每个银行卡必须有一个持卡者、每份资产必须都有一个资产拥有者这样的对应关系。因此针对这种对应关系，创建外键约束。（4 分）</p>\n<p>添加外键约束</p>\n<ol>\n<li>\n<p>信用卡的外键<br />\n ALTER TABLE finance.bank_card ADD CONSTRAINT fk_c_id FOREIGN KEY (b_c_id) REFERENCES finance.client (c_id) ON DELETE CASCADE;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120182046151.png\" alt=\"image-20211120182046151\" /></p>\n</li>\n<li>\n<p>资产的外键<br />\n ALTER TABLE finance.property ADD CONSTRAINT fk_pro_c_id FOREIGN KEY (p_c_id) REFERENCES finance.client (c_id) ON DELETE CASCADE;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120182231938.png\" alt=\"image-20211120182231938\" /></p>\n</li>\n</ol>\n</li>\n<li>\n<p>在理财产品表、保险信息表和基金信息表中，都存在金额这个属性，在现实生活中，金额不会存在负数。因此针对表中金额的属性，增加大于 0 的约束条件。（4 分）</p>\n<p>增加大于 0 的约束</p>\n<ol>\n<li>\n<p>f_products 表<br />\n ALTER table finance.f_products ADD CONSTRAINT c_p_mount CHECK (fp_amount&gt;=0);<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120182747860.png\" alt=\"image-20211120182747860\" /></p>\n</li>\n<li>\n<p>fund 表</p>\n<p>ALTER table finance.fund ADD CONSTRAINT c_f_mount CHECK (f_amount &gt;=0);<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120182809449.png\" alt=\"image-20211120182809449\" /></p>\n</li>\n<li>\n<p>insurance 表<br />\n ALTER table finance.insurance ADD CONSTRAINT c_i_mount CHECK (i_amount&gt;=0);<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120182806605.png\" alt=\"image-20211120182806605\" /></p>\n</li>\n</ol>\n</li>\n<li>\n<p>输出：</p>\n<ol>\n<li>\n<p>输出查询所有表的数据字典的查询语句和结果，可以截图或者复制黏贴代码。(基本都在之前有展示，这里对所有的表及 schema 进行了一次查询)<br />\nselect * from pg_tables;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120183633861.png\" alt=\"image-20211120183633861\" /></p>\n</li>\n<li>\n<p>输出查询所有表的数据的查询语句和结果，可以截图或者复制黏贴代码。</p>\n<ol>\n<li>\n<p>client 表<br />\n select * from finance.client;</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120182955194.png\" alt=\"image-20211120182955194\" /></p>\n</li>\n<li>\n<p>bank_card 表<br />\n select * from finance.bank_card;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120183115059.png\" alt=\"image-20211120183115059\" /></p>\n</li>\n<li>\n<p>fund 表<br />\n select * from finance.fund;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120183213621.png\" alt=\"image-20211120183213621\" /></p>\n</li>\n<li>\n<p>f_products 表<br />\n select * from finance.f_products;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120183232153.png\" alt=\"image-20211120183232153\" /></p>\n</li>\n<li>\n<p>insurance 表<br />\n select * from finance.insurance;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120183242518.png\" alt=\"image-20211120183242518\" /></p>\n</li>\n<li>\n<p>property 表<br />\n select * from finance.property;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120183254782.png\" alt=\"image-20211120183254782\" /></p>\n</li>\n</ol>\n</li>\n<li>\n<p>输出所有创建约束的语句和创建结果，可以截图或者复制黏贴代码 (这在之前已经放上了)</p>\n</li>\n</ol>\n</li>\n</ol>\n</li>\n<li>\n<p>对表中的数据进行查询操作</p>\n<ol>\n<li>\n<p>l  至少完成 1 条单表查询和 1 条表查询。（4 分）<br />\n单表查询 -- 查询客户表中所有的客户 id</p>\n<p>select c_id from finance.client;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120183930730.png\" alt=\"image-20211120183930730\" /></p>\n<p>表查询<br />\n select c_name from finance.client;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120191355193.png\" alt=\"image-20211120191355193\" /></p>\n</li>\n<li>\n<p>l  至少完成两条聚合查询，例如查询用户表中有多少个用户；查询保险信息表中，保险金额的平均值等。（4 分）<br />\n<strong>查询 property 表的 income 平均值</strong><br />\n select avg (p_income) from finance.property<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120191618236.png\" alt=\"image-20211120191618236\" /><br />\n<strong> 查询用户表中用户总数</strong><br />\n select count (*) from finance.client;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120191822353.png\" alt=\"image-20211120191822353\" /></p>\n</li>\n<li>\n<p>l  至少完成 3 条连接查询，例如：半连接、反连接、多表查询和子查询。（6 分）</p>\n<ol>\n<li>等值连接查询，查询每个用户及其拥有的资产<br />\n select finance.client.*,finance.property. *<br />\nfrom finance.client,finance.property<br />\nwhere finance.client.c_id=finance.property.p_c_id;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120192143231.png\" alt=\"image-20211120192143231\" /></li>\n<li>自身连接，在 fund 表中对每一个基金项，查询 manager 和自身 id 相同的基金<br />\n select first.*,second.f_manager<br />\nfrom finance.fund first,finance.fund second<br />\nwhere first.f_id = second.f_manager<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120192923196.png\" alt=\"image-20211120192923196\" /></li>\n<li>子查询，查询和 p_id=3 的资产处于相同状态的资产 (然后发现就它自己冻结着)<br />\nselect * from finance.property<br />\nwhere p_status=<br />\n(select p_status from finance.property where p_id=3);<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120193259515.png\" alt=\"image-20211120193259515\" /></li>\n</ol>\n</li>\n<li>\n<p>至少完成 1 条 ORDER BY 查询。（2 分）<br />\n将资产按照收益逆序输出<br />\n select * from finance.property order by p_income desc;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120193418297.png\" alt=\"image-20211120193418297\" /></p>\n</li>\n<li>\n<p>至少完成 1 条 GROUP BY……HAVING 查询。（4 分）</p>\n</li>\n<li>\n<p>查询收益在 2000 及以上的资产及其平均收益，将结果按 p_id 分组显示，且只显示平均收益大于 2500 的组<br />\n select *,avg (p_income)   from finance.property<br />\nwhere p_income&gt;=2000</p>\n<p>group by p_id<br />\nhaving avg(p_income)&gt;=2500;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120194044403.png\" alt=\"image-20211120194044403\" /></p>\n</li>\n<li>\n<p>查询基金，将其按 f_id 分组，且只显示平均数量大于等于 2000 的组<br />\n select *,avg (f_amount) from finance.fund<br />\ngroup by f_id<br />\nhaving avg(f_amount)&gt;=2000;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120194430725.png\" alt=\"image-20211120194430725\" /></p>\n</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"45-创建视图和索引\"><a class=\"anchor\" href=\"#45-创建视图和索引\">#</a> 4.5 创建视图和索引</h3>\n<ol>\n<li>\n<p>创建一个视图</p>\n<p>查看 client 中属性，除了 c_mail 属性<br />\n create view see_client<br />\nas<br />\nselect c_id,c_name,c_id_card,c_phone,c_password<br />\nfrom finance.client<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120195705769.png\" alt=\"image-20211120195705769\" /></p>\n</li>\n<li>\n<p>修改视图</p>\n<p>修改视图所属 schema<br />\nalter view see_client set schema finance;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120202011203.png\" alt=\"image-20211120202011203\" /></p>\n</li>\n<li>\n<p>使用视图进行查询<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120202005604.png\" alt=\"image-20211120202005604\" /></p>\n</li>\n<li>\n<p>重命名视图<br />\n alter view finance.see_client<br />\nrename to oh_my_god;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120202200841.png\" alt=\"image-20211120202200841\" /></p>\n</li>\n<li>\n<p>删除视图<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120202227819.png\" alt=\"image-20211120202227819\" /></p>\n</li>\n<li>\n<p>创建索引<br />\n为客户电话号码创建索引<br />\n CREATE INDEX index_phone on finance.client (c_phone) ;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120202553719.png\" alt=\"image-20211120202553719\" /></p>\n</li>\n<li>\n<p>重建索引<br />\n对整个客户表重建索引<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120202715402.png\" alt=\"image-20211120202715402\" /></p>\n</li>\n<li>\n<p>重命名索引<br />\n alter index finance.index_phone rename to ind_phone;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120202831047.png\" alt=\"image-20211120202831047\" /></p>\n</li>\n<li>\n<p>删除索引<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120202849544.png\" alt=\"image-20211120202849544\" /></p>\n</li>\n</ol>\n<h3 id=\"146-数据修改和删除5分\"><a class=\"anchor\" href=\"#146-数据修改和删除5分\">#</a> 1.4.6 数据修改和删除（5 分）</h3>\n<p>任务：</p>\n<p>l  修改数据：至少修改 2 个不同的数据。（3 分）</p>\n<ol>\n<li>\n<p>将 client 表中第 1 个元素的值 c_name 改为 ' 年没怀念'<br />\n 之前的表<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120205008902.png\" alt=\"image-20211120205008902\" /><br />\n 修改语句:<br />\nupdate finance.client<br />\nset c_name=' 年没怀念'<br />\nwhere c_id=1;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120205223012.png\" alt=\"image-20211120205223012\" /></p>\n<p>修改后表情况<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120205200129.png\" alt=\"image-20211120205200129\" /></p>\n</li>\n<li>\n<p>将 property 中 p_get_time 小于 2021-11-11 00:00:00 的值修改为 2021-11-19 00:00:00</p>\n<p>修改前状态<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120205546236.png\" alt=\"image-20211120205546236\" /><br />\n 修改<br />\n update finance.property<br />\nset p_get_time='2021-11-19'<br />\nwhere p_get_time&lt;'2021-11-11';<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120205628164.png\" alt=\"image-20211120205628164\" /><br />\n 修改后状态<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120205638384.png\" alt=\"image-20211120205638384\" /></p>\n</li>\n</ol>\n<p>l  删除指定数据：至少删除 2 个不同数据表的数据。（2 分）</p>\n<ol>\n<li>\n<p>将 finance.property 中 p_amount=101 的数据删除</p>\n<p>删除前表情况</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120205638384.png\" alt=\"image-20211120205638384\" /></p>\n<p>删除<br />\n delete from finance.property where p_amount=101;</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120210444230.png\" alt=\"image-20211120210444230\" /></p>\n</li>\n</ol>\n<p>​\t\t删除后表情况<br />\n​\t\t<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120210451058.png\" alt=\"image-20211120210451058\" /></p>\n<ol start=\"2\">\n<li>\n<p>删掉 c_id&gt;20 的用户信息</p>\n<p>删除前表情况</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120210652108.png\" alt=\"image-20211120210652108\" /></p>\n<p>删除操作</p>\n<p>delete from finance.client where c_id&gt;20;<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120210705838.png\" alt=\"image-20211120210705838\" /></p>\n</li>\n</ol>\n<p>​\t\t删除后表情况<br />\n​\t\t<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120210710547.png\" alt=\"image-20211120210710547\" /></p>\n<h3 id=\"147-创建新用户6分\"><a class=\"anchor\" href=\"#147-创建新用户6分\">#</a> 1.4.7 创建新用户（6 分）</h3>\n<p>任务：</p>\n<ol>\n<li>\n<p>新用户的创建和授权：创建用户 dbuser，密码为 Gauss#3demo；给用户 dbuser 授予 finance 数据库下银行卡信息表的查询和插入权限，并将 finance 模式的权限也授予 dbuser 用户。（3 分）</p>\n<p>创建用户<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120210919044.png\" alt=\"image-20211120210919044\" /></p>\n<p>给用户 dbuser 授予 finance 数据库下银行卡信息表的查询和插入权限，并将 finance 模式的权限也授予 dbuser 用户<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120210938886.png\" alt=\"image-20211120210938886\" /></p>\n</li>\n<li>\n<p>新用户连接数据库：使用新用户连接 finance 数据库；访问 finance 数据库的银行卡信息表。（2 分）</p>\n<p>新用户连接</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120211203343.png\" alt=\"image-20211120211203343\" /><br />\n 新用户访问 finance 数据库的银行卡信息表</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120211232019.png\" alt=\"image-20211120211232019\" /></p>\n</li>\n<li>\n<p>删除 finance 模式。（1 分）<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120211528768.png\" alt=\"image-20211120211528768\" /></p>\n</li>\n</ol>\n<h3 id=\"148-使用jdbc连接opengauss数据库\"><a class=\"anchor\" href=\"#148-使用jdbc连接opengauss数据库\">#</a> 1.4.8 使用 jdbc 连接 openGauss 数据库</h3>\n<ol>\n<li>\n<p>创建测试数据库 demo；<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120211928291.png\" alt=\"image-20211120211928291\" /></p>\n</li>\n<li>\n<p>创建名为 demo 的 schema，并设置 demo 为当前的 schema<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120211933670.png\" alt=\"image-20211120211933670\" /><br />\n 设置搜索路径为 demo</p>\n<p>SET search_path TO demo;</p>\n</li>\n<li>\n<p>创建测试表 websites（id,name,url），数据为（'1', 'openGauss', '<a href=\"https://opengauss.org/zh/')%EF%BC%8C('2\">https://opengauss.org/zh/')，('2</a>', ' 华为云 ', '<a href=\"https://www.huaweicloud.com/\">https://www.huaweicloud.com/</a>'), ('3', 'openEuler', '<a href=\"https://openeuler.org/zh/\">https://openeuler.org/zh/</a>'), ('4', ' 华为 support 中心 ', '<a href=\"https://support.huaweicloud.com/\">https://support.huaweicloud.com/</a>')。（3 分）<br />\ncreate table websites<br />\n(<br />\nid Integer primary key,<br />\nname varchar(200),<br />\nurl varchar(200)</p>\n<p>);<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120212236363.png\" alt=\"image-20211120212236363\" /><br />\n 插入数据</p>\n<p>INSERT INTO websites (id,name,url) VALUES</p>\n<p>('1', 'openGauss', '<a href=\"https://opengauss.org/zh/\">https://opengauss.org/zh/</a>'),</p>\n<p>('2', ' 华为云 ', '<a href=\"https://www.huaweicloud.com/\">https://www.huaweicloud.com/</a>'),</p>\n<p>('3', 'openEuler', '<a href=\"https://openeuler.org/zh/\">https://openeuler.org/zh/</a>'),</p>\n<p>('4', ' 华为 support 中心 ', '<a href=\"https://support.huaweicloud.com/\">https://support.huaweicloud.com/</a>')</p>\n<p><img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120212401022.png\" alt=\"image-20211120212401022\" /></p>\n</li>\n<li>\n<p>查看入站规则是否包括 tcp26000 端口<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120213457003.png\" alt=\"image-20211120213457003\" /></p>\n</li>\n<li>\n<p>查看 java 版本是否为 8<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211120213634213.png\" alt=\"image-20211120213634213\" /></p>\n</li>\n<li>\n<p>创建项目，引入 postgres.jar 包<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211206104756935.png\" alt=\"image-20211206104756935\" /></p>\n</li>\n<li>\n<p>写下测试程序如下<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211206104819179.png\" alt=\"image-20211206104819179\" /><br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211206104832554.png\" alt=\"image-20211206104832554\" /></p>\n</li>\n<li>\n<p>结果<br />\n<img src=\"C:%5CUsers%5Cwww13%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211206104851481.png\" alt=\"image-20211206104851481\" /></p>\n</li>\n</ol>\n<p>本实验完成</p>\n",
            "tags": [
                "exp8"
            ]
        }
    ]
}